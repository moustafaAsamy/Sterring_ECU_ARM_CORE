#include "motor.h"
#include "pid.h"
#include "encoder.h"
#include "stdint.h"
#include "ADC.h"
#include "driverlib/sysctl.h"
#include "ports/config.h"
#include "interface/lwip_int.h"
#include "\interface\lwip_int.h"



ip_addr_t ip_addr =         { 0xc0a8017b};
ip_addr_t Remote_ip_addr =  { 0xc0a8016a} ;
ip_addr_t net_mask =        { 0xc0a80000} ;
ip_addr_t gw_addr  =        { 0xc0a82526} ;


u16_t port_local_steering_set_point          = 9001 ;
u16_t port_local_steering_encoder_reading    = 9002 ;
u16_t port_remote_steering_set_point         = 9801;
u16_t port_remote_steering_encoder_reading   = 9802;


struct udp_pcb * Udp_ptr_steering_set_point  ;
struct udp_pcb * Udp_ptr_steering_encoder_reading  ;

extern  uint8_t buffer[100];
extern  struct netif g_sNetIF;

int c =0;
int main()
{


    ecoder_init();
    motor_init();

    Remote_ip_addr.addr=htonl(Remote_ip_addr.addr);
    ECU_int(&g_sNetIF, 0 ,  &ip_addr, &net_mask, &gw_addr);

    uint32_t i =0;
    for(i =0;i<65000;i++)
    {

    }

    Udp_ptr_steering_encoder_reading = udp_new();

    Udp_ptr_steering_set_point       = udp_new();
    err_t result1 =  udp_bind   (  Udp_ptr_steering_set_point  , &ip_addr       ,   port_local_steering_set_point     );
    err_t result2 =  udp_connect(  Udp_ptr_steering_set_point  , &Remote_ip_addr,   port_remote_steering_set_point    );
    Udp_ptr_steering_set_point->recv = UDP_recv_steering_set_point ;                                      ;

    Udp_ptr_steering_encoder_reading = udp_new();
    err_t result1 =  udp_bind   (  Udp_ptr_steering_encoder_reading  , &ip_addr       ,   port_local_steering_encoder_reading     );
    err_t result2 =  udp_connect(  Udp_ptr_steering_encoder_reading  , &Remote_ip_addr,   port_remote_steering_encoder_reading    );
    Udp_ptr_steering_encoder_reading->recv = UDP_recv_steering_encoder_reading ;


    timer_start();
    while(1)
    {

    }
}







